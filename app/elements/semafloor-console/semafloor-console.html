<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="semafloor-console-theme.html">
<link rel="import" href="../semafloor-console-page/semafloor-console-page.html">
<link rel="import" href="../../bower_components/semafloor-search-page/semafloor-search-page.html">

<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">

<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">

<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">

<dom-module id="semafloor-console">
  <template strip-whitespace>
    <style is="custom-style" include="semafloor-console-theme"></style>

    <app-drawer-layout>
      <app-header-layout drawer has-scrolling-region>
        <app-header class="drawer-header">
          <app-toolbar class="drawer-top-toolbar">
            <div class="profile-pic">

            </div>
          </app-toolbar>
          <app-toolbar class="drawer-bottom-toolbar">
            <div class="profile-name">John Doe</div>
            <div class="profile-email">johndoe@jmail.com</div>
          </app-toolbar>
        </app-header>

        <iron-selector class="nav-menu" selected="[[category]]" attr-for-selected="name">
          <a name="home" href="/home/list">Home</a>
          <a name="search" href="/search/list">Search</a>
          <a name="console" href="/console/list">Console</a>
        </iron-selector>
      </app-header-layout>

      <app-header-layout main>
        <app-header class="main-header" condenses fixed effects="material" on-app-header-transform="_onAppHeaderTransform">
          <app-toolbar id="topToolbar" class="main-top-toolbar">
            <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
            <div condensed-title hidden$="[[_isConsole(category)]]">[[category]]</div>
            <div class="console-title" hidden$="[[!_isConsole(category)]]">[[category]]</div>
            <div class="flex"></div>
            <paper-menu-button horizontal-align="right" horizontal-offset="8" vertical-offset="8">
              <paper-icon-button icon="icons:more-vert" class="dropdown-trigger"></paper-icon-button>
              <paper-menu class="dropdown-content" selected="{{view}}" attr-for-selected="view">
                <paper-item view="day">Day View</paper-item>
                <paper-item view="week">Week View</paper-item>
                <paper-item view="month">Month View</paper-item>
              </paper-menu>
            </paper-menu-button>
          </app-toolbar>
          <app-toolbar id="titleToolbar" class="title-toolbar" hidden$="[[_isConsole(category)]]">
            <div title>[[category]]</div>
          </app-toolbar>
          <app-toolbar class="main-middle-toolbar" hidden$="[[!_isConsole(category)]]">
            <paper-tabs selected="{{site}}" bottom-item>
              <paper-tab>KLB - Tower 5</paper-tab>
              <paper-tab>KLB - Tower 2A</paper-tab>
              <paper-tab>SUITE</paper-tab>
            </paper-tabs>
          </app-toolbar>
          <app-toolbar class="main-bottom-toolbar" hidden$="[[!_isConsole(category)]]">
            <paper-tabs id="floorTabs" selected="{{floor}}" bottom-item scrollable>
              <template is="dom-repeat" items="[[_floors]]" index-as="index">
                <paper-tab class="floor-tab">[[item]]</paper-tab>
              </template>
            </paper-tabs>
          </app-toolbar>
        </app-header>

        <iron-pages selected="[[category]]" attr-for-selected="name">
          <div name="home">
            <paper-card heading="Card Title">
              <div class="card-content">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Odit adipisci dignissimos dolore hic id laudantium repellendus saepe impedit, laborum quam. Dolorum magni quibusdam nihil animi praesentium laborum ipsum ut placeat, et aut unde nostrum beatae doloribus saepe, necessitatibus molestias repellendus amet eos debitis asperiores quisquam voluptatem. Commodi voluptas tenetur cumque.
              </div>
              <div class="card-actions">
                <paper-button raised>Some action</paper-button>
              </div>
            </paper-card>

            <paper-card heading="Card Title">
              <div class="card-content">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Odit adipisci dignissimos dolore hic id laudantium repellendus saepe impedit, laborum quam. Dolorum magni quibusdam nihil animi praesentium laborum ipsum ut placeat, et aut unde nostrum beatae doloribus saepe, necessitatibus molestias repellendus amet eos debitis asperiores quisquam voluptatem. Commodi voluptas tenetur cumque.
              </div>
              <div class="card-actions">
                <paper-button raised>Some action</paper-button>
              </div>
            </paper-card>
          </div>

          <semafloor-search-page name="search"></semafloor-search-page>
          <semafloor-console-page name="console" selected-view="[[view]]"></semafloor-console-page>
        </iron-pages>
      </app-header-layout>
    </app-drawer-layout>
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'semafloor-console',

      properties: {
        upgraded: Boolean,
        category: String,
        view: String,
        site: {
          type: String,
          value: 0
        },
        floor: {
          type: String,
          value: 0
        },
        _floors: Array,
        _prevFloor: String,
      },

      observers: [
        '_setFloor(site)',
        '_setPrevFloor(floor)'
      ],

      ready: function() {
        console.log('semafloor-console-ready');
        this.fire('upgraded');
        this.upgraded = true;
      },

      _onAppHeaderTransform: function(ev) {
        this.toggleClass('shrink-change-color', ev.detail.progress > 0.5, this.$.topToolbar);
        this.toggleClass('shrink-change-color', ev.detail.progress > 0.5, this.$.titleToolbar);
      },

      _isConsole: function(_category) {
        return _category === 'console';
      },

      _setFloor: function(_site) {
        this.set('_floors', [['1', '2', '3', '3A', '4', '5', '6',
        '7', '8', '9', '10', '11', '12'], ['3'], ['1']][_site]);
        if (_site === 0) {
          this.set('floor', this._prevFloor);
        }else {
          this.set('floor', 0);
        }
        this.$.floorTabs.notifyResize();
      },

      _setPrevFloor: function(_floor) {
        if (this.site === 0) {
          this.set('_prevFloor', _floor);
        }
      },

    });
  })();
  </script>
</dom-module>
